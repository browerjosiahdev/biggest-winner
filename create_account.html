<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        <title>Biggest Winner</title>
        <link type="text/css" rel="stylesheet" href="css/font.css">
        <link type="text/css" rel="stylesheet" href="css/site.css">
        <script type="text/javascript" language="javascript" src="js/config.js"></script>
        <script type="text/javascript" language="javascript" src="js/jquery-1.11.2.min.js"></script>
        <script type="text/javascript" language="javascript" src="js/site.js"></script>
        <script type="text/javascript" language="javascript">
            function createAccount()
            {
                showPreloader(true);
                
                var strName             = isValidInput($('#name'));
                var strEmail            = isValidInput($('#email'), INPUTEMAIL);
                var strLogin            = isValidInput($('#login'));
                var strPassword         = isValidInput($('#password'));
                var strConfirmPassword  = isValidInput($('#confirmPassword'));
                var bRecieveEmails      = $('#recieveEmails').prop('checked');
                
                if (strName == '')
                    return;
                if (strEmail == '')
                    return;
                if (strLogin == '')
                    return;
                if (strPassword == '')
                    return;
                if (strConfirmPassword == '')
                    return;
                
                if (strPassword != strConfirmPassword)
                {
                    alert("Sorry, your passwords don't match.");
                    
                    return;
                }
                
                var strData = 'name=' + strName +
                              '&email=' + strEmail +
                              '&login=' + strLogin + 
                              '&password=' + strPassword + 
                              '&recieveEmails=' + bRecieveEmails;
                
                $.ajax({
                    url: 'php/create_account.php',
                    method: 'POST',
                    dataType: 'json',
                    data: strData + '&' + DB_URLSTRING,
                    success: onCreateAccountSuccess,
                    error: onCreateAccountError
                });
            }
            
            function onCreateAccountSuccess( jsonData )
            {
                showPreloader(false);
                
                if (jsonData.success)
                {
                    debug('onCreateAccountSuccess(): ' + jsonData.message);                    
                    
                    if (jsonData.data.length > 0)
                        logUserIn(jsonData.data[0].id, jsonData.data[0].name, $('#rememberMe').prop('checked'));
                    else
                        alert('Unable to log you in, please go to the login page and try logging in again.');
                }
                else
                    debug('onCreateAccountSuccess(): ' + jsonData.message);
            }
            
            function onCreateAccountError( jqXHR, textStatus, errorThrown )
            {
                showPreloader(false);
                
                debug('onCreateAccountError(): ' + errorThrown);
            }
        </script>
    </head>
    <body>
        <div class="header">
            <div class="title"><span class="up">Christ</span><span class="">Family</span><span class="down">Temple</span><span class="">Church</span><span class="up">Scriptures</span><span class="">Prayer</span><span class="down">Health</span></div>
        </div>
        <div class="menu">
            <div class="link"><a href="index.html">Home</a></div>
            <div class="link"><a href="scriptures.html">Scriptures</a></div>
        </div>
        <p>Already have an account? Try <a href="login.html">logging in.</a></p>
        <div class="login-form">
            <div class="form-container">
                <div class="form-label">*Name:</div>
                <div class="form-input"><input id="name" class="input-form" type="text"></div>
            </div>
            <div class="form-container">
                <div class="form-label">*Email:</div>
                <div class="form-input"><input id="email" class="input-form" type="email"></div>
            </div>
            <div class="form-container">
                <div class="form-label">*Login:</div>
                <div class="form-input"><input id="login" class="input-form" type="text"></div>
            </div>
            <div class="form-container">
                <div class="form-label">*Password:</div>
                <div class="form-input"><input id="password" class="input-form" type="password"></div>
            </div>
            <div class="form-container">
                <div class="form-label">*Confirm Password:</div>
                <div class="form-input"><input id="confirmPassword" class="input-form" type="password"></div>
            </div>
            Recieve emails when others in the group post? <input id="recieveEmails" type="checkbox" class="checkbox" checked><br/>
            Remember who you are so you don't have to log in? <input id="rememberMe" type="checkbox" class="checkbox"><br/>
            <button type="submit" onclick="javascript:createAccount();">Create Account</button><br/><br/>
        </div>
    </body>
</html>